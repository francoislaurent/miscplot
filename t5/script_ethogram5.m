
behaviors = { ...
    'hunch',    'hunch_large_squares',  'blue'; ...
    'bend',     'cast_large_squares',   'red'; ...
    'back',     'back_large_squares',   'cyan'; ...
    'stop',     'stop_large_squares',   'green'; ...
    'run',      'run_large_squares',    'black'; ...
    'roll',     'roll_large_squares',   'yellow'; ...
    'small',    'small_motion_squares', .5 * [1,1,1]};

state = 'hunch'; % for stimulus train only

ethogram = load('../data/ethogramme.mat');

figure();
set(gca, 'FontSize', 18)

ethogram3(ethogram, ...
    'Behavior', behaviors, ...
    'EventMaxResponseTime', .3, ...
    'EventOnsetTolerance', .2, ...
    'FirstOnsetAsOrigin', true, ...
    'EventOnsetLineWidth', 3, ...
    % continuous stimulation:
    'MaxWindow', [30,60], ...
    'EventOnsetTime', 45, ...
    %'Grouping', {'transition', 'state(-1)', 'state(0)'}, ...
    %'Grouping', {'transition=1,state(-1);transition=0,state(0)', 'state(0)'}, ...
    'Grouping', {'transition=1,state(-1)=hunch,state;transition=0,state(0)=hunch,state;transition=1,state(-1)=bend,state;transition=0,state(0)=bend,state'}, ...
    % short stimulus train:
    %'MaxWindow', [90, 140], ...
    %'EventOnsetTime', [105, 115, 125], ...
    %'EventType', { ...
    %    state, ['~' state], ''; ...
    %    ['~' state], state, ''; ...
    %    }, ...
    %'Grouping', {'type', 'type=1,onset=1,state(-1);type=2,onset=2,state(-1)'}, ...
    %'SortBy', 'type=1,onset=1,end;type=2,onset=2,end', ...
    %
    %'TransitionsOnlyEvent', true, ...
    'FillGaps', 1);

%xlim([100,130])
%ylim([0,260])
%xlabel('time from first stimulus onset (s)')

xlim([-3,3])
ylim([0,4700])
xlabel('Time from stimulus onset (s)')

ylabel('Number of animals')

%print('-depsc', ['train_' state '_prev.eps'])
%print('-depsc', ['by_previous_state.eps'])
%close
